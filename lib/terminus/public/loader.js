var JS=void 0===this.JS?{}:this.JS;JS.Date=Date,function(t){var e="object"==typeof this.global?this.global:this,n="object"==typeof exports;n?(exports.JS=exports,JS=exports):e.JS=JS,t(e,JS)}(function(t,e){"use strict";var n=function(t){n._index(this),this._loader=t,this._names=new r,this._deps=new r,this._uses=new r,this._styles=new r,this._observers={},this._events={}};n.displayName="Package",n.toString=function(){return n.displayName},n.log=function(n){e.debug&&"undefined"!=typeof window&&("object"==typeof t.runtime&&runtime.trace(n),t.console&&console.info&&console.info(n))};var i=function(t){if(/^https?:/.test(t))return t;var n=e.ROOT;return n&&(t=(n+"/"+t).replace(/\/+/g,"/")),t},r=function(t){if(this._members=this.list=[],this._index={},t)for(var e=0,n=t.length;n>e;e++)this.push(t[e])};r.prototype.push=function(t){var e=void 0!==t.id?t.id:t,n=this._index;n.hasOwnProperty(e)||(n[e]=this._members.length,this._members.push(t))};var s=n.Deferred=function(){this._status="deferred",this._value=null,this._callbacks=[]};s.prototype.callback=function(t,e){"succeeded"===this._status?t.call(e,this._value):this._callbacks.push([t,e])},s.prototype.succeed=function(t){this._status="succeeded",this._value=t;for(var e;e=this._callbacks.shift();)e[0].call(e[1],t)},n.ENV=e.ENV=t,n.onerror=function(t){throw t},n._throw=function(t){n.onerror(Error(t))};for(var o=n.prototype,a=[["requires","_deps"],["uses","_uses"]],_=a.length;_--;)(function(t){var e=t[0],n=t[1];o[e]=function(){var t,e=arguments.length;for(t=0;e>t;t++)this[n].push(arguments[t]);return this}})(a[_]);o.provides=function(){var t,e=arguments.length;for(t=0;e>t;t++)this._names.push(arguments[t]),n._getFromCache(arguments[t]).pkg=this;return this},o.styling=function(){for(var t=0,e=arguments.length;e>t;t++)this._styles.push(i(arguments[t]))},o.setup=function(t){return this._onload=t,this},o._on=function(t,e,n){if(this._events[t])return e.call(n);var i=this._observers[t]=this._observers[t]||[];i.push([e,n]),this._load()},o._fire=function(t){if(this._events[t])return!1;this._events[t]=!0;var e=this._observers[t];if(!e)return!0;delete this._observers[t];for(var n=0,i=e.length;i>n;n++)e[n][0].call(e[n][1]);return!0},o._isLoaded=function(t){if(!t&&void 0!==this.__isLoaded)return this.__isLoaded;for(var e,i,r=this._names.list,s=r.length;s--;)if(e=r[s],i=n._getObject(e,this._exports),void 0===i)return t?n._throw("Expected package at "+this._loader+" to define "+e):this.__isLoaded=!1;return this.__isLoaded=!0},o._load=function(){if(this._fire("request")){this._isLoaded()||this._prefetch();var t=this._deps.list.concat(this._uses.list),e=this._source||[],i=(this._loader||{}).length,r=this;n.when({load:t}),n.when({complete:this._deps.list},function(){n.when({complete:t,load:[this]},function(){this._fire("complete")},this);var s=function(t){if(0===i)return o(t);i-=1;var a=r._loader.length-i-1;n.loader.loadFile(r._loader[a],s,e[a])},o=function(t){r._exports=t,r._onload&&r._onload(),r._isLoaded(!0),r._fire("load")};if(this._isLoaded())return this._fire("download"),this._fire("load");if(void 0===this._loader)return n._throw("No load path found for "+this._names.list[0]);if("function"==typeof this._loader?this._loader(o):s(),n.loader.loadStyle){for(var a=this._styles.list,_=a.length;_--;)n.loader.loadStyle(a[_]);this._fire("download")}},this)}},o._prefetch=function(){if(!this._source&&this._loader instanceof Array&&n.loader.fetch){this._source=[];for(var t=0,e=this._loader.length;e>t;t++)this._source[t]=n.loader.fetch(this._loader[t])}},o.toString=function(){return"Package:"+this._names.list.join(",")},n.when=function(t,e,i){var s,o,a,_=[],u={};for(s in t)if(t.hasOwnProperty(s))for(u[s]=[],o=new r(t[s]),a=o.list.length;a--;)_.push([s,o.list[a],a]);var l=a=_.length;if(0===l)return e&&e.call(i,u);for(;a--;)(function(t){var r=n._getByName(t[1]);r._on(t[0],function(){u[t[0]][t[2]]=n._getObject(t[1],r._exports),l-=1,0===l&&e&&e.call(i,u)})})(_[a])};var u=(t.JS||{}).Package||{};n._autoIncrement=u._autoIncrement||1,n._indexByPath=u._indexByPath||{},n._indexByName=u._indexByName||{},n._autoloaders=u._autoloaders||[],n._index=function(t){t.id=this._autoIncrement,this._autoIncrement+=1},n._getByPath=function(t){var e=""+t,n=this._indexByPath[e];return n?n:("string"==typeof t&&(t=[].slice.call(arguments)),n=this._indexByPath[e]=new this(t))},n._getByName=function(t){if("string"!=typeof t)return t;var e=this._getFromCache(t);if(e.pkg)return e.pkg;var n=this._manufacture(t);if(n)return n;var i=new this;return i.provides(t),i},n.remove=function(t){var e=this._getByName(t);delete this._indexByName[t],delete this._indexByPath[e._loader]},n._autoload=function(t,e){this._autoloaders.push([t,e])},n._manufacture=function(t){var e,n,i,r,s=this._autoloaders,o=s.length;for(e=0;o>e;e++)if(i=s[e],i[0].test(t)){r=i[1].from,"string"==typeof r&&(r=this._convertNameToPath(r));var a=new this([r(t)]);if(a.provides(t),r=i[1].require)for(r=[].concat(r),n=r.length;n--;)a.requires(t.replace(i[0],r[n]));return a}return null},n._convertNameToPath=function(t){return function(e){return t.replace(/\/?$/,"/")+e.replace(/([a-z])([A-Z])/g,function(t,e,n){return e+"_"+n}).replace(/\./g,"/").toLowerCase()+".js"}},n._getFromCache=function(t){return this._indexByName[t]=this._indexByName[t]||{}},n._getObject=function(t,e){if("string"!=typeof t)return void 0;var n=e?{}:this._getFromCache(t);if(void 0!==n.obj)return n.obj;for(var i,r=e||this.ENV,s=t.split(".");i=s.shift();)r=r&&r[i];return e&&void 0===r?this._getObject(t):n.obj=r},n.BrowserLoader={HOST_REGEX:/^(https?\:)?\/\/[^\/]+/i,usable:function(){return!!n._getObject("window.document.getElementsByTagName")&&"undefined"==typeof phantom},__FILE__:function(){var t=document.getElementsByTagName("script"),e=t[t.length-1].src,n=window.location.href;return/^\w+\:\/+/.test(e)?e:/^\//.test(e)?window.location.origin+e:n.replace(/[^\/]*$/g,"")+e},cacheBust:function(t){if(e.cache!==!1)return t;var n=(new JS.Date).getTime();return t+(/\?/.test(t)?"&":"?")+n},fetch:function(t){var e=t;t=this.cacheBust(t),this.HOST=this.HOST||this.HOST_REGEX.exec(window.location.href);var i=this.HOST_REGEX.exec(t);if(!this.HOST||i&&i[0]!==this.HOST[0])return null;n.log("[FETCH] "+t);var r=new n.Deferred,s=this,o=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;return o.open("GET",t,!0),o.onreadystatechange=function(){4===o.readyState&&(o.onreadystatechange=s._K,r.succeed(o.responseText+"\n//@ sourceURL="+e),o=null)},o.send(null),r},loadFile:function(t,e,i){i||(t=this.cacheBust(t));var r=this,s=document.getElementsByTagName("head")[0],o=document.createElement("script");return o.type="text/javascript",i?i.callback(function(i){n.log("[EXEC]  "+t);var r=Function("code","eval(code)");r(i),e()}):(n.log("[LOAD] "+t),o.src=t,o.onload=o.onreadystatechange=function(){var t=o.readyState,n=o.status;(!t||"loaded"===t||"complete"===t||4===t&&200===n)&&(e(),o.onload=o.onreadystatechange=r._K,s=null,o=null)},s.appendChild(o),void 0)},loadStyle:function(t){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=this.cacheBust(t),document.getElementsByTagName("head")[0].appendChild(e)},_K:function(){}},n.loader=n.BrowserLoader;var l={__FILE__:function(){return n.loader.__FILE__()},pkg:function(t,e){var i=e?n._getByPath(e):n._getByName(t);return i.provides(t),i},file:function(){for(var t=[],e=arguments.length;e--;)t[e]=i(arguments[e]);return n._getByPath.apply(n,t)},load:function(t,e){n.loader.loadFile(t,e)},autoload:function(t,e){n._autoload(t,e)}};l.files=l.file,l.loader=l.file;var h=function(t){t.call(l)},c=function(t){for(var e=[],n=0;"string"==typeof t[n];)e.push(t[n]),n+=1;return{files:e,callback:t[n],context:t[n+1]}};e.load=function(){var t=c(arguments),e=t.files.length,i=function(r){return r===e?t.callback.call(t.context):(n.loader.loadFile(t.files[r],function(){i(r+1)}),void 0)};i(0)},e.require=function(){var t=c(arguments);return n.when({complete:t.files},function(e){t.callback&&t.callback.apply(t.context,e&&e.complete)}),this},e.Package=n,e.Packages=e.packages=h,e.DSL=l});
//@ sourceMappingURL=package-browser.js.map