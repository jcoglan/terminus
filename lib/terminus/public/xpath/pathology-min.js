var Pathology={evaluate:function(b,a,e,d,h){h=h||new Pathology.XPathResult(d);var c=Pathology.XPathParser.parse(b);c.evaluate(a,a,d,h);return h},atomize:function(b,a,e){var d=b.evaluate(a,e);if(d&&d.atomize)d=d.atomize();return d},array:function(b){if(!b)return[];var a=[],e=b.length;while(e--)a[e]=b[e];return a}};if(typeof XPathResult==='undefined'){XPathResult={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9}}if(typeof document.evaluate==='undefined'){document.evaluate=function(){return Pathology.evaluate.apply(Pathology,arguments)}}Pathology.XPathResult=function(b){this._4=b;this._3=[];this._5=0};Pathology.XPathResult.prototype.push=function(b){if(this._4!==0&&b.nodeType!==this._4)return;if(this._3.indexOf(b)>=0)return;this._3.push(b)};Pathology.XPathResult.prototype.iterateNext=function(){var b=this._3[this._5];if(!b)return null;this._5+=1;return b};Pathology.XPathResult.prototype.forEach=function(b,a){for(var e=0,d=this._3.length;e<d;e++)b.call(a,this._3[e],e)};Pathology.XPathResult.prototype.atomize=function(){if(this._3.length===0)return null;if(this._3.length===1){var b=this._3[0];if(b.nodeValue===undefined||b.nodeValue===null)return b;return b.nodeValue}else{var a=[];for(var e=0,d=this._3.length;e<d;e++)a.push(this._3[e].nodeValue);return a}};Pathology.XPathResult.prototype.makeString=function(){var a=this._3[0];if(!a)return'';switch(a.nodeType){case XPathResult.STRING_TYPE:return this.atomize();case XPathResult.BOOLEAN_TYPE:var e=[];this.forEach(function(b){e.push(b.nodeValue)});return e.join('');default:var d=document.evaluate('//text()',a,null,XPathResult.ANY_TYPE,null);return d.makeString()}};(function(){var k=function(b,a){if(!b||!a)return b;for(var e in a){if(b[e]!==a[e])b[e]=a[e]}return b};var G=function(b,a){var e=a.split('.'),d;while(d=e.shift()){b=b[d];if(b===undefined)throw new Error('Cannot find object named '+a);}return b};var bB=function(b){var a=b.input.split(/\n/g),e=0,d=0;while(d<b.offset+1){d+=a[e].length+1;e+=1}var h='Line '+e+': expected '+b.expected+'\n',c=a[e-1];h+=c+'\n';d-=c.length+1;while(d<b.offset){h+=' ';d+=1}return h+'^'};var br={__consume__union_expression:function(b){var a=null,e=this._0;this._2["union_expression"]=this._2["union_expression"]||{};var d=this._2["union_expression"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;f=this.__consume__location_path();if(f){c.push(f);j+=f.textValue;g.head=f;var i=null;var m=0,p=this._0,q=[],n="",l=true;while(l){var o=this._0,r=[],t={},v="";var s=null;s=this.__consume__space();if(s){r.push(s);v+=s.textValue;t.space=s;var u=null;var w=null;if(this._1.length>this._0){w=this._1.substring(this._0,this._0+1)}else{w=null}if(w==="|"){var y=this.constructor.SyntaxNode;var z=null;u=new y("|",this._0,[]);if(typeof z==="object"){k(u,z)}this._0+=1}else{u=null;var A=null;if(this._1.length>this._0){A=this._1.substring(this._0,this._0+1)}else{A=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"|\""}}}if(u){r.push(u);v+=u.textValue;var x=null;x=this.__consume__space();if(x){r.push(x);v+=x.textValue;t.space=x;var B=null;B=this.__consume__location_path();if(B){r.push(B);v+=B.textValue;t.location_path=B}else{r=null;this._0=o}}else{r=null;this._0=o}}else{r=null;this._0=o}}else{r=null;this._0=o}if(r){this._0=o;var H=this.constructor.SyntaxNode;var D=null;l=new H(v,this._0,r,t);if(typeof D==="object"){k(l,D)}this._0+=v.length}else{l=null}if(l){q.push(l);n+=l.textValue;m-=1}}if(m<=0){this._0=p;var K=this.constructor.SyntaxNode;var C=null;i=new K(n,this._0,q);if(typeof C==="object"){k(i,C)}this._0+=n.length}else{i=null}if(i){c.push(i);j+=i.textValue;g.rest=i}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var M=this.constructor.SyntaxNode;var N=G(this.constructor,"Union");a=new M(j,this._0,c,g);if(typeof N==="object"){k(a,N)}this._0+=j.length}else{a=null}return this._2["union_expression"][e]=a},__consume__location_path:function(b){var a=null,e=this._0;this._2["location_path"]=this._2["location_path"]||{};var d=this._2["location_path"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;f=this.__consume__location_step();if(f){c.push(f);j+=f.textValue;g.head=f;var i=null;var m=0,p=this._0,q=[],n="",l=true;while(l){l=this.__consume__location_step();if(l){q.push(l);n+=l.textValue;m-=1}}if(m<=0){this._0=p;var o=this.constructor.SyntaxNode;var r=null;i=new o(n,this._0,q);if(typeof r==="object"){k(i,r)}this._0+=n.length}else{i=null}if(i){c.push(i);j+=i.textValue;g.rest=i}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var t=this.constructor.SyntaxNode;var v=G(this.constructor,"LocationPath");a=new t(j,this._0,c,g);if(typeof v==="object"){k(a,v)}this._0+=j.length}else{a=null}return this._2["location_path"][e]=a},__consume__location_step:function(b){var a=null,e=this._0;this._2["location_step"]=this._2["location_step"]||{};var d=this._2["location_step"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;var i=this._0;var m=null;if(this._1.length>this._0){m=this._1.substring(this._0,this._0+1)}else{m=null}if(m==="/"){var p=this.constructor.SyntaxNode;var q=null;f=new p("/",this._0,[]);if(typeof q==="object"){k(f,q)}this._0+=1}else{f=null;var n=null;if(this._1.length>this._0){n=this._1.substring(this._0,this._0+1)}else{n=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"/\""}}}if(f){}else{this._0=i;var l=this.constructor.SyntaxNode;var o=null;f=new l("",this._0,[]);if(typeof o==="object"){k(f,o)}this._0+=0}if(f){c.push(f);j+=f.textValue;var r=null;var t=this._0;var v=this._0,s=[],u={},w="";var y=null;y=this.__consume__axis();if(y){s.push(y);w+=y.textValue;u.axis=y;var z=null;var A=this._0;z=this.__consume__node_test();if(z){}else{this._0=A;var x=this.constructor.SyntaxNode;var B=null;z=new x("",this._0,[]);if(typeof B==="object"){k(z,B)}this._0+=0}if(z){s.push(z);w+=z.textValue;u.test=z}else{s=null;this._0=v}}else{s=null;this._0=v}if(s){this._0=v;var H=this.constructor.SyntaxNode;var D=null;r=new H(w,this._0,s,u);if(typeof D==="object"){k(r,D)}this._0+=w.length}else{r=null}if(r){}else{this._0=t;var K=this._0,C=[],M={},N="";var I=null;var bC=this._0;I=this.__consume__axis();if(I){}else{this._0=bC;var bs=this.constructor.SyntaxNode;var bt=null;I=new bs("",this._0,[]);if(typeof bt==="object"){k(I,bt)}this._0+=0}if(I){C.push(I);N+=I.textValue;M.axis=I;var W=null;W=this.__consume__node_test();if(W){C.push(W);N+=W.textValue;M.test=W}else{C=null;this._0=K}}else{C=null;this._0=K}if(C){this._0=K;var be=this.constructor.SyntaxNode;var bu=null;r=new be(N,this._0,C,M);if(typeof bu==="object"){k(r,bu)}this._0+=N.length}else{r=null}if(r){}else{this._0=t}}if(r){c.push(r);j+=r.textValue;g.selector=r;var L=null;var bv=this._0;var X=this._0,E=[],O={},P="";var Y=null;var bf=null;if(this._1.length>this._0){bf=this._1.substring(this._0,this._0+1)}else{bf=null}if(bf==="["){var bw=this.constructor.SyntaxNode;var bx=null;Y=new bw("[",this._0,[]);if(typeof bx==="object"){k(Y,bx)}this._0+=1}else{Y=null;var bl=null;if(this._1.length>this._0){bl=this._1.substring(this._0,this._0+1)}else{bl=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"[\""}}}if(Y){E.push(Y);P+=Y.textValue;var Z=null;Z=this.__consume__space();if(Z){E.push(Z);P+=Z.textValue;O.space=Z;var Q=null;Q=this.__consume__integer();if(Q){E.push(Q);P+=Q.textValue;O.integer=Q;var J=null;J=this.__consume__space();if(J){E.push(J);P+=J.textValue;O.space=J;var ba=null;var R=null;if(this._1.length>this._0){R=this._1.substring(this._0,this._0+1)}else{R=null}if(R==="]"){var bb=this.constructor.SyntaxNode;var bg=null;ba=new bb("]",this._0,[]);if(typeof bg==="object"){k(ba,bg)}this._0+=1}else{ba=null;var by=null;if(this._1.length>this._0){by=this._1.substring(this._0,this._0+1)}else{by=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"]\""}}}if(ba){E.push(ba);P+=ba.textValue}else{E=null;this._0=X}}else{E=null;this._0=X}}else{E=null;this._0=X}}else{E=null;this._0=X}}else{E=null;this._0=X}if(E){this._0=X;var bz=this.constructor.SyntaxNode;var bm=null;L=new bz(P,this._0,E,O);if(typeof bm==="object"){k(L,bm)}this._0+=P.length}else{L=null}if(L){}else{this._0=bv;var bc=this.constructor.SyntaxNode;var bn=null;L=new bc("",this._0,[]);if(typeof bn==="object"){k(L,bn)}this._0+=0}if(L){c.push(L);j+=L.textValue;g.subscript=L;var S=null;var bo=0,bp=this._0,F=[],bh="",T=true;while(T){T=this.__consume__node_predicate();if(T){F.push(T);bh+=T.textValue;bo-=1}}if(bo<=0){this._0=bp;var bd=this.constructor.SyntaxNode;var bA=null;S=new bd(bh,this._0,F);if(typeof bA==="object"){k(S,bA)}this._0+=bh.length}else{S=null}if(S){c.push(S);j+=S.textValue;g.predicates=S}else{c=null;this._0=h}}else{c=null;this._0=h}}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var bi=this.constructor.SyntaxNode;var U=G(this.constructor,"LocationStep");a=new bi(j,this._0,c,g);if(typeof U==="object"){k(a,U)}this._0+=j.length}else{a=null}return this._2["location_step"][e]=a},__consume__axis:function(b){var a=null,e=this._0;this._2["axis"]=this._2["axis"]||{};var d=this._2["axis"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=this._0,g=[],j={},f="";var i=null;var m=1,p=this._0,q=[],n="",l=true;while(l){var o=null;if(this._1.length>this._0){o=this._1.substring(this._0,this._0+1)}else{o=null}if(o&&/^[a-z\-]/.test(o)){var r=this.constructor.SyntaxNode;var t=null;l=new r(o,this._0,[]);if(typeof t==="object"){k(l,t)}this._0+=1}else{l=null;var v=null;if(this._1.length>this._0){v=this._1.substring(this._0,this._0+1)}else{v=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[a-z\\-]"}}}if(l){q.push(l);n+=l.textValue;m-=1}}if(m<=0){this._0=p;var s=this.constructor.SyntaxNode;var u=null;i=new s(n,this._0,q);if(typeof u==="object"){k(i,u)}this._0+=n.length}else{i=null}if(i){g.push(i);f+=i.textValue;j.axis_name=i;var w=null;var y=null;if(this._1.length>this._0){y=this._1.substring(this._0,this._0+2)}else{y=null}if(y==="::"){var z=this.constructor.SyntaxNode;var A=null;w=new z("::",this._0,[]);if(typeof A==="object"){k(w,A)}this._0+=2}else{w=null;var x=null;if(this._1.length>this._0){x=this._1.substring(this._0,this._0+1)}else{x=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"::\""}}}if(w){g.push(w);f+=w.textValue}else{g=null;this._0=c}}else{g=null;this._0=c}if(g){this._0=c;var B=this.constructor.SyntaxNode;var H=null;a=new B(f,this._0,g,j);if(typeof H==="object"){k(a,H)}this._0+=f.length}else{a=null}if(a){}else{this._0=h;a=this.__consume__axis_shorthand();if(a){}else{this._0=h}}return this._2["axis"][e]=a},__consume__axis_shorthand:function(b){var a=null,e=this._0;this._2["axis_shorthand"]=this._2["axis_shorthand"]||{};var d=this._2["axis_shorthand"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=null;if(this._1.length>this._0){c=this._1.substring(this._0,this._0+1)}else{c=null}if(c==="@"){var g=this.constructor.SyntaxNode;var j=null;a=new g("@",this._0,[]);if(typeof j==="object"){k(a,j)}this._0+=1}else{a=null;var f=null;if(this._1.length>this._0){f=this._1.substring(this._0,this._0+1)}else{f=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"@\""}}}if(a){}else{this._0=h;var i=null;if(this._1.length>this._0){i=this._1.substring(this._0,this._0+2)}else{i=null}if(i===".."){var m=this.constructor.SyntaxNode;var p=null;a=new m("..",this._0,[]);if(typeof p==="object"){k(a,p)}this._0+=2}else{a=null;var q=null;if(this._1.length>this._0){q=this._1.substring(this._0,this._0+1)}else{q=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"..\""}}}if(a){}else{this._0=h;var n=null;if(this._1.length>this._0){n=this._1.substring(this._0,this._0+1)}else{n=null}if(n==="."){var l=this.constructor.SyntaxNode;var o=null;a=new l(".",this._0,[]);if(typeof o==="object"){k(a,o)}this._0+=1}else{a=null;var r=null;if(this._1.length>this._0){r=this._1.substring(this._0,this._0+1)}else{r=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\".\""}}}if(a){}else{this._0=h;var t=null;if(this._1.length>this._0){t=this._1.substring(this._0,this._0+1)}else{t=null}if(t==="/"){var v=this.constructor.SyntaxNode;var s=null;a=new v("/",this._0,[]);if(typeof s==="object"){k(a,s)}this._0+=1}else{a=null;var u=null;if(this._1.length>this._0){u=this._1.substring(this._0,this._0+1)}else{u=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"/\""}}}if(a){}else{this._0=h}}}}return this._2["axis_shorthand"][e]=a},__consume__node_test:function(b){var a=null,e=this._0;this._2["node_test"]=this._2["node_test"]||{};var d=this._2["node_test"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;a=this.__consume__node_condition();if(a){var c=G(this.constructor,"NodeTest");if(typeof c==="object"){k(a,c)}}else{this._0=h;a=this.__consume__node_name();if(a){var g=G(this.constructor,"NodeTest");if(typeof g==="object"){k(a,g)}}else{this._0=h;var j=null;if(this._1.length>this._0){j=this._1.substring(this._0,this._0+1)}else{j=null}if(j==="*"){var f=this.constructor.SyntaxNode;var i=null;a=new f("*",this._0,[]);if(typeof i==="object"){k(a,i)}this._0+=1}else{a=null;var m=null;if(this._1.length>this._0){m=this._1.substring(this._0,this._0+1)}else{m=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"*\""}}}if(a){var p=G(this.constructor,"NodeTest");if(typeof p==="object"){k(a,p)}}else{this._0=h}}}return this._2["node_test"][e]=a},__consume__node_condition:function(b){var a=null,e=this._0;this._2["node_condition"]=this._2["node_condition"]||{};var d=this._2["node_condition"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;var i=1,m=this._0,p=[],q="",n=true;while(n){var l=null;if(this._1.length>this._0){l=this._1.substring(this._0,this._0+1)}else{l=null}if(l&&/^[a-z\-]/.test(l)){var o=this.constructor.SyntaxNode;var r=null;n=new o(l,this._0,[]);if(typeof r==="object"){k(n,r)}this._0+=1}else{n=null;var t=null;if(this._1.length>this._0){t=this._1.substring(this._0,this._0+1)}else{t=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[a-z\\-]"}}}if(n){p.push(n);q+=n.textValue;i-=1}}if(i<=0){this._0=m;var v=this.constructor.SyntaxNode;var s=null;f=new v(q,this._0,p);if(typeof s==="object"){k(f,s)}this._0+=q.length}else{f=null}if(f){c.push(f);j+=f.textValue;g.condition_name=f;var u=null;var w=null;if(this._1.length>this._0){w=this._1.substring(this._0,this._0+2)}else{w=null}if(w==="()"){var y=this.constructor.SyntaxNode;var z=null;u=new y("()",this._0,[]);if(typeof z==="object"){k(u,z)}this._0+=2}else{u=null;var A=null;if(this._1.length>this._0){A=this._1.substring(this._0,this._0+1)}else{A=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"()\""}}}if(u){c.push(u);j+=u.textValue}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var x=this.constructor.SyntaxNode;var B=null;a=new x(j,this._0,c,g);if(typeof B==="object"){k(a,B)}this._0+=j.length}else{a=null}return this._2["node_condition"][e]=a},__consume__node_name:function(b){var a=null,e=this._0;this._2["node_name"]=this._2["node_name"]||{};var d=this._2["node_name"][e];if(d){this._0+=d.textValue.length;return d}var h=1,c=this._0,g=[],j="",f=true;while(f){var i=null;if(this._1.length>this._0){i=this._1.substring(this._0,this._0+1)}else{i=null}if(i&&/^[A-Za-z0-9\-]/.test(i)){var m=this.constructor.SyntaxNode;var p=null;f=new m(i,this._0,[]);if(typeof p==="object"){k(f,p)}this._0+=1}else{f=null;var q=null;if(this._1.length>this._0){q=this._1.substring(this._0,this._0+1)}else{q=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[A-Za-z0-9\\-]"}}}if(f){g.push(f);j+=f.textValue;h-=1}}if(h<=0){this._0=c;var n=this.constructor.SyntaxNode;var l=null;a=new n(j,this._0,g);if(typeof l==="object"){k(a,l)}this._0+=j.length}else{a=null}return this._2["node_name"][e]=a},__consume__node_predicate:function(b){var a=null,e=this._0;this._2["node_predicate"]=this._2["node_predicate"]||{};var d=this._2["node_predicate"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;var i=null;if(this._1.length>this._0){i=this._1.substring(this._0,this._0+1)}else{i=null}if(i==="["){var m=this.constructor.SyntaxNode;var p=null;f=new m("[",this._0,[]);if(typeof p==="object"){k(f,p)}this._0+=1}else{f=null;var q=null;if(this._1.length>this._0){q=this._1.substring(this._0,this._0+1)}else{q=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"[\""}}}if(f){c.push(f);j+=f.textValue;var n=null;n=this.__consume__expression();if(n){c.push(n);j+=n.textValue;g.expression=n;var l=null;var o=null;if(this._1.length>this._0){o=this._1.substring(this._0,this._0+1)}else{o=null}if(o==="]"){var r=this.constructor.SyntaxNode;var t=null;l=new r("]",this._0,[]);if(typeof t==="object"){k(l,t)}this._0+=1}else{l=null;var v=null;if(this._1.length>this._0){v=this._1.substring(this._0,this._0+1)}else{v=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"]\""}}}if(l){c.push(l);j+=l.textValue}else{c=null;this._0=h}}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var s=this.constructor.SyntaxNode;var u=null;a=new s(j,this._0,c,g);if(typeof u==="object"){k(a,u)}this._0+=j.length}else{a=null}return this._2["node_predicate"][e]=a},__consume__expression:function(b){var a=null,e=this._0;this._2["expression"]=this._2["expression"]||{};var d=this._2["expression"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;a=this.__consume__or_expression();if(a){}else{this._0=h;a=this.__consume__and_expression();if(a){}else{this._0=h;a=this.__consume__comparison();if(a){}else{this._0=h;a=this.__consume__atom();if(a){}else{this._0=h}}}}return this._2["expression"][e]=a},__consume__or_expression:function(b){var a=null,e=this._0;this._2["or_expression"]=this._2["or_expression"]||{};var d=this._2["or_expression"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=this._0,g=[],j={},f="";var i=null;i=this.__consume__and_expression();if(i){g.push(i);f+=i.textValue;j.left=i;var m=null;var p=null;if(this._1.length>this._0){p=this._1.substring(this._0,this._0+2)}else{p=null}if(p==="or"){var q=this.constructor.SyntaxNode;var n=null;m=new q("or",this._0,[]);if(typeof n==="object"){k(m,n)}this._0+=2}else{m=null;var l=null;if(this._1.length>this._0){l=this._1.substring(this._0,this._0+1)}else{l=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"or\""}}}if(m){g.push(m);f+=m.textValue;var o=null;o=this.__consume__or_expression();if(o){g.push(o);f+=o.textValue;j.right=o}else{g=null;this._0=c}}else{g=null;this._0=c}}else{g=null;this._0=c}if(g){this._0=c;var r=this.constructor.SyntaxNode;var t=G(this.constructor,"Or");a=new r(f,this._0,g,j);if(typeof t==="object"){k(a,t)}this._0+=f.length}else{a=null}if(a){}else{this._0=h;a=this.__consume__and_expression();if(a){}else{this._0=h}}return this._2["or_expression"][e]=a},__consume__and_expression:function(b){var a=null,e=this._0;this._2["and_expression"]=this._2["and_expression"]||{};var d=this._2["and_expression"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=this._0,g=[],j={},f="";var i=null;i=this.__consume__comparison();if(i){g.push(i);f+=i.textValue;j.left=i;var m=null;var p=null;if(this._1.length>this._0){p=this._1.substring(this._0,this._0+3)}else{p=null}if(p==="and"){var q=this.constructor.SyntaxNode;var n=null;m=new q("and",this._0,[]);if(typeof n==="object"){k(m,n)}this._0+=3}else{m=null;var l=null;if(this._1.length>this._0){l=this._1.substring(this._0,this._0+1)}else{l=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"and\""}}}if(m){g.push(m);f+=m.textValue;var o=null;o=this.__consume__and_expression();if(o){g.push(o);f+=o.textValue;j.right=o}else{g=null;this._0=c}}else{g=null;this._0=c}}else{g=null;this._0=c}if(g){this._0=c;var r=this.constructor.SyntaxNode;var t=G(this.constructor,"And");a=new r(f,this._0,g,j);if(typeof t==="object"){k(a,t)}this._0+=f.length}else{a=null}if(a){}else{this._0=h;a=this.__consume__comparison();if(a){}else{this._0=h}}return this._2["and_expression"][e]=a},__consume__comparison:function(b){var a=null,e=this._0;this._2["comparison"]=this._2["comparison"]||{};var d=this._2["comparison"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=this._0,g=[],j={},f="";var i=null;i=this.__consume__atom();if(i){g.push(i);f+=i.textValue;j.left=i;var m=null;m=this.__consume__comparator();if(m){g.push(m);f+=m.textValue;j.comparator=m;var p=null;p=this.__consume__comparison();if(p){g.push(p);f+=p.textValue;j.right=p}else{g=null;this._0=c}}else{g=null;this._0=c}}else{g=null;this._0=c}if(g){this._0=c;var q=this.constructor.SyntaxNode;var n=G(this.constructor,"Comparison");a=new q(f,this._0,g,j);if(typeof n==="object"){k(a,n)}this._0+=f.length}else{a=null}if(a){}else{this._0=h;a=this.__consume__atom();if(a){}else{this._0=h}}return this._2["comparison"][e]=a},__consume__comparator:function(b){var a=null,e=this._0;this._2["comparator"]=this._2["comparator"]||{};var d=this._2["comparator"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=null;if(this._1.length>this._0){c=this._1.substring(this._0,this._0+2)}else{c=null}if(c==="!="){var g=this.constructor.SyntaxNode;var j=null;a=new g("!=",this._0,[]);if(typeof j==="object"){k(a,j)}this._0+=2}else{a=null;var f=null;if(this._1.length>this._0){f=this._1.substring(this._0,this._0+1)}else{f=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"!=\""}}}if(a){}else{this._0=h;var i=null;if(this._1.length>this._0){i=this._1.substring(this._0,this._0+1)}else{i=null}if(i==="="){var m=this.constructor.SyntaxNode;var p=null;a=new m("=",this._0,[]);if(typeof p==="object"){k(a,p)}this._0+=1}else{a=null;var q=null;if(this._1.length>this._0){q=this._1.substring(this._0,this._0+1)}else{q=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"=\""}}}if(a){}else{this._0=h}}return this._2["comparator"][e]=a},__consume__atom:function(b){var a=null,e=this._0;this._2["atom"]=this._2["atom"]||{};var d=this._2["atom"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;f=this.__consume__space();if(f){c.push(f);j+=f.textValue;g.space=f;var i=null;var m=this._0;var p=this._0,q=[],n={},l="";var o=null;var r=null;if(this._1.length>this._0){r=this._1.substring(this._0,this._0+1)}else{r=null}if(r==="("){var t=this.constructor.SyntaxNode;var v=null;o=new t("(",this._0,[]);if(typeof v==="object"){k(o,v)}this._0+=1}else{o=null;var s=null;if(this._1.length>this._0){s=this._1.substring(this._0,this._0+1)}else{s=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"(\""}}}if(o){q.push(o);l+=o.textValue;var u=null;u=this.__consume__expression();if(u){q.push(u);l+=u.textValue;n.in_parens=u;var w=null;var y=null;if(this._1.length>this._0){y=this._1.substring(this._0,this._0+1)}else{y=null}if(y===")"){var z=this.constructor.SyntaxNode;var A=null;w=new z(")",this._0,[]);if(typeof A==="object"){k(w,A)}this._0+=1}else{w=null;var x=null;if(this._1.length>this._0){x=this._1.substring(this._0,this._0+1)}else{x=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\")\""}}}if(w){q.push(w);l+=w.textValue}else{q=null;this._0=p}}else{q=null;this._0=p}}else{q=null;this._0=p}if(q){this._0=p;var B=this.constructor.SyntaxNode;var H=null;i=new B(l,this._0,q,n);if(typeof H==="object"){k(i,H)}this._0+=l.length}else{i=null}if(i){}else{this._0=m;i=this.__consume__value();if(i){}else{this._0=m}}if(i){c.push(i);j+=i.textValue;g.expression=i;var D=null;D=this.__consume__space();if(D){c.push(D);j+=D.textValue;g.space=D}else{c=null;this._0=h}}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var K=this.constructor.SyntaxNode;var C=G(this.constructor,"Atom");a=new K(j,this._0,c,g);if(typeof C==="object"){k(a,C)}this._0+=j.length}else{a=null}return this._2["atom"][e]=a},__consume__value:function(b){var a=null,e=this._0;this._2["value"]=this._2["value"]||{};var d=this._2["value"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;a=this.__consume__function_call();if(a){}else{this._0=h;a=this.__consume__string();if(a){}else{this._0=h;a=this.__consume__union_expression();if(a){}else{this._0=h}}}return this._2["value"][e]=a},__consume__function_call:function(b){var a=null,e=this._0;this._2["function_call"]=this._2["function_call"]||{};var d=this._2["function_call"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;f=this.__consume__function_name();if(f){c.push(f);j+=f.textValue;g.function_name=f;var i=null;var m=null;if(this._1.length>this._0){m=this._1.substring(this._0,this._0+1)}else{m=null}if(m==="("){var p=this.constructor.SyntaxNode;var q=null;i=new p("(",this._0,[]);if(typeof q==="object"){k(i,q)}this._0+=1}else{i=null;var n=null;if(this._1.length>this._0){n=this._1.substring(this._0,this._0+1)}else{n=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"(\""}}}if(i){c.push(i);j+=i.textValue;var l=null;l=this.__consume__function_args();if(l){c.push(l);j+=l.textValue;g.function_args=l;var o=null;var r=null;if(this._1.length>this._0){r=this._1.substring(this._0,this._0+1)}else{r=null}if(r===")"){var t=this.constructor.SyntaxNode;var v=null;o=new t(")",this._0,[]);if(typeof v==="object"){k(o,v)}this._0+=1}else{o=null;var s=null;if(this._1.length>this._0){s=this._1.substring(this._0,this._0+1)}else{s=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\")\""}}}if(o){c.push(o);j+=o.textValue}else{c=null;this._0=h}}else{c=null;this._0=h}}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var u=this.constructor.SyntaxNode;var w=G(this.constructor,"FunctionCall");a=new u(j,this._0,c,g);if(typeof w==="object"){k(a,w)}this._0+=j.length}else{a=null}return this._2["function_call"][e]=a},__consume__function_name:function(b){var a=null,e=this._0;this._2["function_name"]=this._2["function_name"]||{};var d=this._2["function_name"][e];if(d){this._0+=d.textValue.length;return d}var h=1,c=this._0,g=[],j="",f=true;while(f){var i=null;if(this._1.length>this._0){i=this._1.substring(this._0,this._0+1)}else{i=null}if(i&&/^[a-z\-]/.test(i)){var m=this.constructor.SyntaxNode;var p=null;f=new m(i,this._0,[]);if(typeof p==="object"){k(f,p)}this._0+=1}else{f=null;var q=null;if(this._1.length>this._0){q=this._1.substring(this._0,this._0+1)}else{q=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[a-z\\-]"}}}if(f){g.push(f);j+=f.textValue;h-=1}}if(h<=0){this._0=c;var n=this.constructor.SyntaxNode;var l=null;a=new n(j,this._0,g);if(typeof l==="object"){k(a,l)}this._0+=j.length}else{a=null}return this._2["function_name"][e]=a},__consume__function_args:function(b){var a=null,e=this._0;this._2["function_args"]=this._2["function_args"]||{};var d=this._2["function_args"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=this._0,g=[],j={},f="";var i=null;i=this.__consume__expression();if(i){g.push(i);f+=i.textValue;j.first=i;var m=null;var p=0,q=this._0,n=[],l="",o=true;while(o){var r=this._0,t=[],v={},s="";var u=null;var w=null;if(this._1.length>this._0){w=this._1.substring(this._0,this._0+1)}else{w=null}if(w===","){var y=this.constructor.SyntaxNode;var z=null;u=new y(",",this._0,[]);if(typeof z==="object"){k(u,z)}this._0+=1}else{u=null;var A=null;if(this._1.length>this._0){A=this._1.substring(this._0,this._0+1)}else{A=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\",\""}}}if(u){t.push(u);s+=u.textValue;var x=null;x=this.__consume__expression();if(x){t.push(x);s+=x.textValue;v.expression=x}else{t=null;this._0=r}}else{t=null;this._0=r}if(t){this._0=r;var B=this.constructor.SyntaxNode;var H=null;o=new B(s,this._0,t,v);if(typeof H==="object"){k(o,H)}this._0+=s.length}else{o=null}if(o){n.push(o);l+=o.textValue;p-=1}}if(p<=0){this._0=q;var D=this.constructor.SyntaxNode;var K=null;m=new D(l,this._0,n);if(typeof K==="object"){k(m,K)}this._0+=l.length}else{m=null}if(m){g.push(m);f+=m.textValue;j.rest=m}else{g=null;this._0=c}}else{g=null;this._0=c}if(g){this._0=c;var C=this.constructor.SyntaxNode;var M=null;a=new C(f,this._0,g,j);if(typeof M==="object"){k(a,M)}this._0+=f.length}else{a=null}if(a){}else{this._0=h;var N=this.constructor.SyntaxNode;var I=null;a=new N("",this._0,[]);if(typeof I==="object"){k(a,I)}this._0+=0}return this._2["function_args"][e]=a},__consume__integer:function(b){var a=null,e=this._0;this._2["integer"]=this._2["integer"]||{};var d=this._2["integer"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0,c=[],g={},j="";var f=null;var i=null;if(this._1.length>this._0){i=this._1.substring(this._0,this._0+1)}else{i=null}if(i&&/^[1-9]/.test(i)){var m=this.constructor.SyntaxNode;var p=null;f=new m(i,this._0,[]);if(typeof p==="object"){k(f,p)}this._0+=1}else{f=null;var q=null;if(this._1.length>this._0){q=this._1.substring(this._0,this._0+1)}else{q=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[1-9]"}}}if(f){c.push(f);j+=f.textValue;var n=null;var l=0,o=this._0,r=[],t="",v=true;while(v){var s=null;if(this._1.length>this._0){s=this._1.substring(this._0,this._0+1)}else{s=null}if(s&&/^[0-9]/.test(s)){var u=this.constructor.SyntaxNode;var w=null;v=new u(s,this._0,[]);if(typeof w==="object"){k(v,w)}this._0+=1}else{v=null;var y=null;if(this._1.length>this._0){y=this._1.substring(this._0,this._0+1)}else{y=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[0-9]"}}}if(v){r.push(v);t+=v.textValue;l-=1}}if(l<=0){this._0=o;var z=this.constructor.SyntaxNode;var A=null;n=new z(t,this._0,r);if(typeof A==="object"){k(n,A)}this._0+=t.length}else{n=null}if(n){c.push(n);j+=n.textValue}else{c=null;this._0=h}}else{c=null;this._0=h}if(c){this._0=h;var x=this.constructor.SyntaxNode;var B=G(this.constructor,"Integer");a=new x(j,this._0,c,g);if(typeof B==="object"){k(a,B)}this._0+=j.length}else{a=null}return this._2["integer"][e]=a},__consume__string:function(b){var a=null,e=this._0;this._2["string"]=this._2["string"]||{};var d=this._2["string"][e];if(d){this._0+=d.textValue.length;return d}var h=this._0;var c=this._0,g=[],j={},f="";var i=null;var m=null;if(this._1.length>this._0){m=this._1.substring(this._0,this._0+1)}else{m=null}if(m==="'"){var p=this.constructor.SyntaxNode;var q=null;i=new p("'",this._0,[]);if(typeof q==="object"){k(i,q)}this._0+=1}else{i=null;var n=null;if(this._1.length>this._0){n=this._1.substring(this._0,this._0+1)}else{n=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"'\""}}}if(i){g.push(i);f+=i.textValue;var l=null;var o=0,r=this._0,t=[],v="",s=true;while(s){var u=this._0;var w=this._0,y=[],z={},A="";var x=null;var B=null;if(this._1.length>this._0){B=this._1.substring(this._0,this._0+1)}else{B=null}if(B==="\\"){var H=this.constructor.SyntaxNode;var D=null;x=new H("\\",this._0,[]);if(typeof D==="object"){k(x,D)}this._0+=1}else{x=null;var K=null;if(this._1.length>this._0){K=this._1.substring(this._0,this._0+1)}else{K=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"\\\\\""}}}if(x){y.push(x);A+=x.textValue;var C=null;var M=null;if(this._1.length>this._0){M=this._1.substring(this._0,this._0+1)}else{M=null}var N=M;if(N===null){C=null;var I=null;if(this._1.length>this._0){I=this._1.substring(this._0,this._0+1)}else{I=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"<any char>"}}}else{var bC=this.constructor.SyntaxNode;var bs=null;C=new bC(N,this._0,[]);if(typeof bs==="object"){k(C,bs)}this._0+=1}if(C){y.push(C);A+=C.textValue}else{y=null;this._0=w}}else{y=null;this._0=w}if(y){this._0=w;var bt=this.constructor.SyntaxNode;var W=null;s=new bt(A,this._0,y,z);if(typeof W==="object"){k(s,W)}this._0+=A.length}else{s=null}if(s){}else{this._0=u;var be=null;if(this._1.length>this._0){be=this._1.substring(this._0,this._0+1)}else{be=null}if(be&&/^[^']/.test(be)){var bu=this.constructor.SyntaxNode;var L=null;s=new bu(be,this._0,[]);if(typeof L==="object"){k(s,L)}this._0+=1}else{s=null;var bv=null;if(this._1.length>this._0){bv=this._1.substring(this._0,this._0+1)}else{bv=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[^']"}}}if(s){}else{this._0=u}}if(s){t.push(s);v+=s.textValue;o-=1}}if(o<=0){this._0=r;var X=this.constructor.SyntaxNode;var E=null;l=new X(v,this._0,t);if(typeof E==="object"){k(l,E)}this._0+=v.length}else{l=null}if(l){g.push(l);f+=l.textValue;var O=null;var P=null;if(this._1.length>this._0){P=this._1.substring(this._0,this._0+1)}else{P=null}if(P==="'"){var Y=this.constructor.SyntaxNode;var bf=null;O=new Y("'",this._0,[]);if(typeof bf==="object"){k(O,bf)}this._0+=1}else{O=null;var bw=null;if(this._1.length>this._0){bw=this._1.substring(this._0,this._0+1)}else{bw=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"'\""}}}if(O){g.push(O);f+=O.textValue}else{g=null;this._0=c}}else{g=null;this._0=c}}else{g=null;this._0=c}if(g){this._0=c;var bx=this.constructor.SyntaxNode;var bl=null;a=new bx(f,this._0,g,j);if(typeof bl==="object"){k(a,bl)}this._0+=f.length}else{a=null}if(a){var Z=G(this.constructor,"String");if(typeof Z==="object"){k(a,Z)}}else{this._0=h;var Q=this._0,J=[],ba={},R="";var bb=null;var bg=null;if(this._1.length>this._0){bg=this._1.substring(this._0,this._0+1)}else{bg=null}if(bg==="\""){var by=this.constructor.SyntaxNode;var bz=null;bb=new by("\"",this._0,[]);if(typeof bz==="object"){k(bb,bz)}this._0+=1}else{bb=null;var bm=null;if(this._1.length>this._0){bm=this._1.substring(this._0,this._0+1)}else{bm=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"\\\"\""}}}if(bb){J.push(bb);R+=bb.textValue;var bc=null;var bn=0,S=this._0,bo=[],bp="",F=true;while(F){var bh=this._0;var T=this._0,bd=[],bA={},bi="";var U=null;var bD=null;if(this._1.length>this._0){bD=this._1.substring(this._0,this._0+1)}else{bD=null}if(bD==="\\"){var bV=this.constructor.SyntaxNode;var bH=null;U=new bV("\\",this._0,[]);if(typeof bH==="object"){k(U,bH)}this._0+=1}else{U=null;var bI=null;if(this._1.length>this._0){bI=this._1.substring(this._0,this._0+1)}else{bI=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"\\\\\""}}}if(U){bd.push(U);bi+=U.textValue;var bj=null;var bE=null;if(this._1.length>this._0){bE=this._1.substring(this._0,this._0+1)}else{bE=null}var bJ=bE;if(bJ===null){bj=null;var bK=null;if(this._1.length>this._0){bK=this._1.substring(this._0,this._0+1)}else{bK=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"<any char>"}}}else{var bW=this.constructor.SyntaxNode;var bL=null;bj=new bW(bJ,this._0,[]);if(typeof bL==="object"){k(bj,bL)}this._0+=1}if(bj){bd.push(bj);bi+=bj.textValue}else{bd=null;this._0=T}}else{bd=null;this._0=T}if(bd){this._0=T;var bX=this.constructor.SyntaxNode;var bM=null;F=new bX(bi,this._0,bd,bA);if(typeof bM==="object"){k(F,bM)}this._0+=bi.length}else{F=null}if(F){}else{this._0=bh;var bq=null;if(this._1.length>this._0){bq=this._1.substring(this._0,this._0+1)}else{bq=null}if(bq&&/^[^"]/.test(bq)){var bY=this.constructor.SyntaxNode;var bN=null;F=new bY(bq,this._0,[]);if(typeof bN==="object"){k(F,bN)}this._0+=1}else{F=null;var bO=null;if(this._1.length>this._0){bO=this._1.substring(this._0,this._0+1)}else{bO=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"[^\"]"}}}if(F){}else{this._0=bh}}if(F){bo.push(F);bp+=F.textValue;bn-=1}}if(bn<=0){this._0=S;var bZ=this.constructor.SyntaxNode;var bP=null;bc=new bZ(bp,this._0,bo);if(typeof bP==="object"){k(bc,bP)}this._0+=bp.length}else{bc=null}if(bc){J.push(bc);R+=bc.textValue;var bk=null;var bF=null;if(this._1.length>this._0){bF=this._1.substring(this._0,this._0+1)}else{bF=null}if(bF==="\""){var ca=this.constructor.SyntaxNode;var bQ=null;bk=new ca("\"",this._0,[]);if(typeof bQ==="object"){k(bk,bQ)}this._0+=1}else{bk=null;var bR=null;if(this._1.length>this._0){bR=this._1.substring(this._0,this._0+1)}else{bR=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\"\\\"\""}}}if(bk){J.push(bk);R+=bk.textValue}else{J=null;this._0=Q}}else{J=null;this._0=Q}}else{J=null;this._0=Q}if(J){this._0=Q;var cb=this.constructor.SyntaxNode;var bS=null;a=new cb(R,this._0,J,ba);if(typeof bS==="object"){k(a,bS)}this._0+=R.length}else{a=null}if(a){var bT=G(this.constructor,"String");if(typeof bT==="object"){k(a,bT)}}else{this._0=h}}return this._2["string"][e]=a},__consume__space:function(b){var a=null,e=this._0;this._2["space"]=this._2["space"]||{};var d=this._2["space"][e];if(d){this._0+=d.textValue.length;return d}var h=0,c=this._0,g=[],j="",f=true;while(f){var i=null;if(this._1.length>this._0){i=this._1.substring(this._0,this._0+1)}else{i=null}if(i===" "){var m=this.constructor.SyntaxNode;var p=null;f=new m(" ",this._0,[]);if(typeof p==="object"){k(f,p)}this._0+=1}else{f=null;var q=null;if(this._1.length>this._0){q=this._1.substring(this._0,this._0+1)}else{q=null}if(!this.error||this.error.offset<=this._0){this.error=this.constructor.lastError={input:this._1,offset:this._0,expected:"\" \""}}}if(f){g.push(f);j+=f.textValue;h-=1}}if(h<=0){this._0=c;var n=this.constructor.SyntaxNode;var l=null;a=new n(j,this._0,g);if(typeof l==="object"){k(a,l)}this._0+=j.length}else{a=null}return this._2["space"][e]=a}};var V=function(b){this._1=b;this._0=0;this._2={}};V.prototype.parse=function(){var b=this.__consume__union_expression();if(b&&this._0===this._1.length){return b}if(!(this.error)){this.error={input:this._1,offset:this._0,expected:"<EOF>"}}var a=bB(this.error);var e=new Error(a);throw e;};V.parse=function(b){var a=new V(b);return a.parse()};k(V.prototype,br);var bU=function(b,a,e,d){this.textValue=b;this.offset=a;this.elements=e||[];if(!d)return;for(var h in d)this[h]=d[h]};bU.prototype.forEach=function(b,a){for(var e=0,d=this.elements.length;e<d;e++){b.call(a,this.elements[e],e)}};V.SyntaxNode=bU;if(typeof require==="function"&&typeof exports==="object"){exports.Grammar=br;exports.Parser=V;exports.parse=V.parse;if(typeof Pathology!=="undefined"){Pathology.XPath=br;Pathology.XPathParser=V;Pathology.XPathParser.formatError=bB}}else{var bG=this;bG=bG.Pathology=bG.Pathology||{};Pathology.XPath=br;Pathology.XPathParser=V;Pathology.XPathParser.formatError=bB}})();Pathology.XPathParser.And={evaluate:function(b,a){return Pathology.atomize(this.left,b,a)&&Pathology.atomize(this.right,b,a)}};Pathology.XPathParser.Atom={evaluate:function(b,a){var e=this.expression.in_parens||this.expression;return e.evaluate(b,a)}};Pathology.Axis=function(b){this.name=b};Pathology.Axis.prototype.walk=function(b,a,e){var d=b.childNodes,h=Pathology.array(b.attributes),c;if(b.checked)h.push({nodeName:'checked',nodeValue:true,nodeType:XPathResult.STRING_TYPE});if(b.selected)h.push({nodeName:'selected',nodeValue:true,nodeType:XPathResult.STRING_TYPE});switch(this.name){case'attribute':for(var g=0,j=h.length;g<j;g++){a.call(e,h[g])}break;case'child':for(var g=0,j=d.length;g<j;g++){a.call(e,d[g])}break;case'descendant-or-self':a.call(e,b);for(var g=0,j=d.length;g<j;g++){this.walk(d[g],a,e)}break;case'following-sibling':c=b.nextSibling;while(c){a.call(e,c);c=c.nextSibling}break;case'parent':a.call(e,b.parentNode);break;case'self':a.call(e,b);break}};Pathology.Axis.SHORTHANDS={'@':'attribute','..':'parent','.':'self','/':'descendant-or-self','':'child'};Pathology.Axis.fromAST=function(b){var a=b.axis_name?b.axis_name.textValue:b.textValue;return new this(this.SHORTHANDS[a]||a)};Pathology.XPathParser.Comparison={evaluate:function(a,e){var d=this.comparator.textValue,h=this.left.evaluate(a,e),c=Pathology.atomize(this.right,a,e),g=false,j=(c instanceof Array);if(h.forEach){h.forEach(function(b){switch(d){case'=':g=g||(j?c.indexOf(b.nodeValue)>=0:(b.nodeValue==c||b.innerHTML==c));break;case'!=':g=g||(j?c.indexOf(b.nodeValue)<0:b.nodeValue!=c);break}});return g}else{switch(d){case'=':return c instanceof Array?c.indexOf(h.nodeValue)>=0:h==c;case'!=':return c instanceof Array?c.indexOf(node.nodeValue)<0:h!=c}}}};Pathology.XPathParser.FunctionCall={getArguments:function(a,e){var d=[];if(this.function_args.first&&this.function_args.first.evaluate){d.push(this.function_args.first.evaluate(a,e))}if(this.function_args.rest){this.function_args.rest.forEach(function(b){d.push(b.expression.evaluate(a,e))})}return d},evaluate:function(b,a){var e=this.getArguments(b,a),d=this.REGISTER[this.function_name.textValue];return d.apply(b,e)},REGISTER:{'concat':function(){var b='';for(var a=0,e=arguments.length;a<e;a++)b+=arguments[a].makeString?arguments[a].makeString():arguments[a];return b},'contains':function(b,a){if(!b)return false;if(b.makeString)b=b.makeString();return b.toString().indexOf(a)>=0},'normalize-space':function(b){if(b.makeString)b=b.makeString();return b.toString().replace(/^\s*/g,'').replace(/\s*$/g,'').replace(/\s+/g,' ')},'name':function(){return this.nodeName.toLowerCase()},'not':function(b){if(b&&b.atomize)b=b.atomize();if(typeof b==='string')return false;return!b},'string':function(b){return b.atomize().innerText},'text':function(){return document.evaluate('/text()',this,null,XPathResult.ANY_TYPE,null)}}};Pathology.XPathParser.LocationPath={eachStep:function(b,a){b.call(a,this.head);this.rest.forEach(b,a)},evaluate:function(d,h,c,g){g=g||new Pathology.XPathResult(XPathResult.ANY_TYPE);c=c||XPathResult.ANY_TYPE;var j=new Pathology.XPathResult(c),f=this.head.isRelative()?d:h;j.push(f);this.eachStep(function(a){var e=new Pathology.XPathResult(c);j.forEach(function(b){a.evaluate(b,h,c,e)});j=e});j.forEach(g.push,g);return g}};Pathology.XPathParser.LocationStep={isRelative:function(){return this.elements[0].textValue!=='/'},evaluate:function(e,d,h,c){var g=this.selector.axis,j=this.selector.test,f=[];Pathology.Axis.fromAST(g).walk(e,function(b,a){if(!j||!j.evaluate)return c.push(b);j.evaluate(b,this.subscript,this.predicates,d,h,f,c)},this)}};Pathology.XPathParser.NodeTest={evaluate:function(a,e,d,h,c,g,j){var f=this.condition_name;if(f&&f.textValue==='node'){}else if(f&&f.textValue==='text'){if(a.nodeType!==XPathResult.BOOLEAN_TYPE)return}else{var i=this.textValue.toLowerCase();if(i==='*'){if(a.nodeType!==1)return}else{if(!a.nodeName)return;if(a.nodeName.toLowerCase()!==i)return}}g.push(a);if(e.integer){if(e.integer.evaluate()!==g.length)return}var m=true;d.forEach(function(b){m=m&&Pathology.atomize(b.expression,a,h);if(typeof m==='string')m=true});if(m)j.push(a)}};Pathology.XPathParser.Or={evaluate:function(b,a){return Pathology.atomize(this.left,b,a)||Pathology.atomize(this.right,b,a)}};Pathology.XPathParser.Integer={evaluate:function(b,a){return parseInt(this.textValue,10)}};Pathology.XPathParser.String={evaluate:function(b,a){return eval(this.textValue)}};Pathology.XPathParser.Union={eachPath:function(a,e){a.call(e,this.head);this.rest.forEach(function(b){a.call(e,b.location_path)})},evaluate:function(a,e,d,h){h=h||new Pathology.XPathResult(XPathResult.ANY_TYPE);d=d||XPathResult.ANY_TYPE;this.eachPath(function(b){b.evaluate(a,e,d,h)});return h}};
//@ sourceMappingURL=pathology-min.js.map